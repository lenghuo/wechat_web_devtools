'use strict';!function(require,directRequire){function a(a){return a=a||global.appVersion,a+='',a=a.replace(/\./g,''),parseInt(a)}function b(a,b){if(!a&&!b)return 0;if(!a)return-1;if(!b)return 1;const c=/\d+/g,d=a.match(c),e=b.match(c);if(!d)return 1;if(!e)return-1;const f=d.map((a)=>parseInt(a)),g=e.map((a)=>parseInt(a)),h=d.length>e.length?e.length:d.length;for(let c=0;c<h;c++){if(f[c]<g[c])return-1;if(f[c]>g[c])return 1}return f.length===g.length?0:f.length<g.length?-1:1}function c(){let a=nw.App.getDataPath(),b=l.join(a,'Secure Preferences'),c=k.readFileSync(b,'utf8'),d=JSON.parse(c),{extensions:e}=d,{settings:f}=e,g=chrome.runtime.id,h=f[g];h.events=[],h.filtered_events={},k.writeFileSync(b+'_temp',JSON.stringify(d));let i=require('./d28a711224425b00101635efe1034c99.js'),j=l.join(q.WeappLog,`fixpreferences.log`);k.writeFileSync(b,JSON.stringify(d));let m=t.spawn(i.getFixpreferencesPath(),[b,`${b}_temp`,j,300],{stdio:'ignore',detached:!0});m.unref()}function d(){s&&c(),nw.App.quit()}function e(a){try{if(a=l.resolve(a),!k.existsSync(a))return;let b=k.statSync(a);if(b.isDirectory()){let b=k.readdirSync(a);if(0<b.length)for(let c=0,d=b.length;c<d;c++)e(l.join(a,b[c]));k.rmdirSync(a)}else k.unlinkSync(a)}catch(a){}}function f(a,b){try{if(a=l.resolve(a),b=l.resolve(b),!k.existsSync(a))return;if(k.existsSync(b)){let c=k.statSync(b),d=k.statSync(a);if(d.isDirectory()&&c.isDirectory()){let c=k.readdirSync(a);for(let d=0,e=c.length;d<e;d++)f(l.join(a,c[d]),l.join(b,c[d]));return void k.rmdirSync(a)}c.isDirectory()&&rmdirSync(b)}k.renameSync(a,b)}catch(a){}}function g(a){if(a=l.resolve(a),k.existsSync(a)){let b=k.statSync(a);if(b.isDirectory())return;k.unlinkSync(a)}g(l.dirname(a)),k.mkdirSync(a)}function h(a,b){if(a=l.resolve(a),b=l.resolve(b),!!k.existsSync(a)){let c=k.lstatSync(a);if(c.isDirectory()){g(b);let c=k.readdirSync(a);for(let d=0,e=c.length;d<e;d++)h(l.join(a,c[d]),l.join(b,c[d]))}else{if(k.existsSync(b)){let a=k.lstatSync(b);if(a.isDirectory()){let a=l.dirname(b),c=l.join(a,''+Math.random());for(;k.existsSync(c)||c==b;)c=l.join(a,''+Math.random());k.renameSync(b,c)}}g(l.dirname(b)),k.writeFileSync(b,k.readFileSync(a),{mode:w(c.mode)})}}}function i(a){const b=n.createHash('md5');return b.update(a),b.digest('hex')}function j(a,b='`'){return a?'`'===b?a.replace(/\\/g,'\\\\').replace(/`/g,'\\`').replace(/\$/g,'\\$'):'"'===b?a.replace(/\\/g,'\\\\').replace(/\r\n/g,'\n').replace(/\n/g,'\\n').replace(/"/g,'\\"'):'\''===b?a.replace(/\\/g,'\\\\').replace(/\r\n/g,'\n').replace(/\n/g,'\\n').replace(/'/g,'\\\''):void 0:a}const k=require('fs'),l=require('path'),m=require('http'),n=require('crypto'),o=require('./84858de8a097c9cf84ff2c2e3d86e2a9.js'),p=require('./72653d4b93cdd7443296229431a7aa9a.js'),q=require('./92320c1386e6db6a6f2556736a9bc280.js'),r=require('./f171257bbcaef547a3cf27266ccb0db2.js'),s='darwin'===process.platform,t=require('child_process'),u=require('./8baad0631295efb1130774c37d944951.js');var v=9973;const w=(a)=>{let b;return b='number'==typeof a?a.toString(8):a,b.substring(b.length-3)},x=function(){let a=0;return function(b){a++;const{data:c,type:d,autoRemove:e}=b,f=j(c,'`');let g='';return'text'===d?(g=`scriptNode.text = \`${f}`,g+=e?`;
        const node = global.__global.document.getElementById('\${fnName}');
        node.parentElement.removeChild(node)
        \``:'`;'):'link'===d&&(g=`scriptNode.src = \`${f}\`;`,e&&(g+=`scriptNode.onload = function() {
          const node = document.getElementById(fnName);
          node.parentElement.removeChild(node)
        }`)),`
      ;(function(global){
        const container = document.getElementsByTagName("head")[0]
        const scriptNode = document.createElement('script')
        scriptNode.type = "text/javascript";
        const fnName = "script${a}"
        scriptNode.id = fnName
        ${g}
        container.appendChild(scriptNode)
      })(this);
    `}}();module.exports={getAvailablePort:async function(){return u.findFreePort('127.0.0.1')},getType:function(a){return Object.prototype.toString.call(a).toLowerCase().split(' ')[1].replace(']','')},getAppConfig:function(){return{isDev:!!process.execPath.match('nw.exe')||!!process.execPath.match('nwjs.app')||!!process.execPath.match('nwjs.exe'),isBeta:!0===nw.App.manifest.beta,isGamma:!0===nw.App.manifest.gamma}},checkUpdateApp:async function(){return new Promise((b,c)=>{let e=global.appVersion,f=q.WeappApplication;if(o.forceUpdateVersion){let g=o.forceUpdateVersion;o.removeForceUpdateVersion();let h=a(g),i=a(e),j='';if(i<h)j=`当前${e}版本太旧，请正在新版本${g}...`;else if(i>h)j=`当前版本${e}存在问题, 回退至版本${g}...`;else return b();const m=s?'darwin':'x64'===process.arch?'x64':'ia32';let n=`${m}_${g.replace(/\./g,'')}.${s?'dmg':'exe'}`,p=l.join(f,n);if(k.existsSync(p)){let a=global.contentDocument.querySelector('#container');a.innerHTML=`<div class="app-up-data" style="text-align:center;margin-top: 50%; font-size: 16px;padding:20px;">${j}</div>`;let b=s?'open':n,e=s?[n]:[];try{let c=t.spawn(b,e,{detached:!0,cwd:f});c.on('close',(b)=>{0!==b&&(a.innerHTML='<div class="app-up-data" style="text-align:center;margin-top: 50%;font-size: 16px; padding:20px;">\u66F4\u65B0\u5931\u8D25\uFF0C\u8BF7\u91CD\u65B0\u542F\u52A8</div>'),setTimeout(()=>{d()},2e3)})}catch(a){setTimeout(()=>{nw.Shell.openItem(l.join(f,n)),setTimeout(()=>{d()},2e3)},200)}return c()}}b()})},openInspectWin:function(){nw.Window.open('about:blank',{show:!1,width:799,height:799},(a)=>{a.maximize(),a.window.location='chrome://inspect/#devices',a.show()})},getVersionNum:a,compareLibVersion:function(a,c){return b(a,c)},compareSemVer:b,quit:d,rmSync:e,mvSync:f,cpSync:h,mkdirSync:g,getQuery:function(a=''){a=a.replace(/^\?/,'');let b=a.split('&'),c={};for(let d,e=0,f=b.length;e<f;e++)d=(b[e]||'').split('='),c[d[0]]=decodeURIComponent(d[1]);return c},normalizePath:function(a=''){const b=l.posix.normalize(a.replace(/\\/g,'/'));return(a.startsWith('//')||a.startsWith('\\\\'))&&!b.startsWith('//')?'/'+b:b},generateMD5:i,chooseFile:async function(a){const b=global.windowMap.get('MAIN').window,c=document.createElement('input');return c.style.display='none',c.setAttribute('type','file'),a.accept&&c.setAttribute('accept',a.accept),a.multiple&&c.setAttribute('multiple','multiple'),b.document.body.appendChild(c),c.click(),new Promise((a)=>{c.addEventListener('change',(d)=>{b.document.body.removeChild(c),a({success:!0,event:d})}),c.addEventListener('cancel',(d)=>{b.document.body.removeChild(c),a({success:!1,event:d})})})},fillArray:function(b,c){if(0==c)return[];for(var d=[b];2*d.length<=c;)d=d.concat(d);return d.length<c&&(d=d.concat(d.slice(0,c-d.length))),d},random:function(){return i(Math.random()+''+Date.now())},escapeScript:function(a){return a?a.replace(/<script/g,'&lt;script').replace(/<\/script/g,'&lt;/script'):a},executeScript:function(a,b){const{code:c,webview:d}=a;if(d&&c){let a=`(function(){
    delete this.nw;
    this.chrome = null
  })();`;d._webview?d._webview.executeScript({code:a+c},b):d.executeScript({code:a+c},b)}},escapeQuot:j,webviewScriptCreator:x,shouldUseConfigFile:function(a){if('darwin'!==process.platform){if(128<a.length)return!0;for(const b of a)if(1e4<b.length)return!0}return!1}}}(require('lazyload'),require);