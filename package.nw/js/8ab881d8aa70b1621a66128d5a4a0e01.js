;!function(require, directRequire){;"use strict";const tslib_1=require("tslib"),React=require("react"),report=require('./da7c31daaf542cf1796023d8e344b98a.js'),locales=require('./common/locales/index.js');let ProjectManagement=class extends React.Component{constructor(a){super(a),this.toggleCheckbox=(a)=>{const b=a.currentTarget.dataset.id;b&&this.setState({checked:Object.assign({},this.state.checked,{[b]:!this.state.checked[b]})})},this.toggleAllCheckbox=()=>{const a={};Object.keys(this.props.list).filter(this.filterProject).forEach((b)=>a[b]=!this.state.checked[b]),this.setState({checked:a})},this.onDel=async(a)=>{const b=this.props.list[a.currentTarget.dataset.id];if(b){this.beforeOperation();const a=await this.props.confirm({id:b.projectpath,title:locales.config.PROJECT_DELETE_TITLE.format(b.projectname),content:locales.config.PROJECT_DELETE_CONTENT});if(this.afterOperation(),a)try{this.props.removeProject(b.projectid)}catch(a){}this.setState({checked:Object.assign({},this.state.checked,{[b.projectid]:void 0})}),report("weapp_manager_del")}},this.beforeOperation=()=>{this.props.win&&this.props.win.setAlwaysOnTop(!0),this.setState({showMask:!0})},this.afterOperation=()=>{this.props.win&&this.props.win.setAlwaysOnTop(!1),this.setState({showMask:!1})},this.onDelMultiple=async()=>{const a=Object.keys(this.state.checked).filter((a)=>this.state.checked[a]);if(a&&0!==a.length){const b=a.filter((a)=>this.props.list[a]).map((a)=>this.props.list[a]),c=b.map((a)=>a.projectname).join("\uFF0C");this.beforeOperation();const d=await this.props.confirm({id:"PM-MULTI-DEL",title:locales.config.PROJECT_DELETE_TITLE.format(c),content:locales.config.PROJECT_DELETE_CONTENT});if(this.afterOperation(),d)for(const a of b)try{this.props.removeProject(a.projectid);const c=Object.assign({},this.state.checked);for(const a of b)delete c[a.projectid];this.setState({checked:c})}catch(a){}report("weapp_manager_multi_del")}},this.onNew=()=>{"minicode"===this.props.projectManagementWindow.type?this.props.createMiniCodeRequest():this.props.createProjectRequest(),this.props.closeProjectManagement(),report("weapp_manager_add")},this.compareProject=(c,a)=>{try{return(this.props.list[a].accessTime||1)-(this.props.list[c].accessTime||1)}catch(a){return 1}},this.filterProject=(a)=>{if(this.props.projectManagementWindow.filter)try{return this.props.projectManagementWindow.filter(this.props.list[a])}catch(a){return!0}else return!0},this.state={checked:{},showMask:!1};try{a.win.focus()}catch(a){}}render(){const a=Object.keys(this.props.list).filter(this.filterProject).sort(this.compareProject).map((a)=>{const b=this.props.list[a],c=b.attr&&b.attr.appImageUrl||"";return React.createElement("div",{className:"pm-item ui-flex",key:a},React.createElement("div",{className:"pm-item-hd"},React.createElement("label",{className:"ui-checkbox"},React.createElement("input",{type:"checkbox"}),React.createElement("i",{className:this.state.checked[a]?"ui-icon-checkbox-o":"ui-icon-checkbox",onClick:this.toggleCheckbox,"data-id":a}))),React.createElement("div",{className:"pm-item-bd ui-flex ui-flex-item"},React.createElement("div",{className:"pm-item-logo"},React.createElement("img",{src:c})),React.createElement("div",{className:"pm-item-info ui-flex-item"},React.createElement("h3",{className:"pm-item-name"},decodeURIComponent(b.projectname)),React.createElement("p",{className:"pm-item-desc"},b.projectpath))),React.createElement("div",{className:"pm-item-ft",onClick:this.onDel,"data-id":a},React.createElement("a",null,React.createElement("i",{className:"ui-icon-trash"}))))});let b=!0;for(const a in this.state.checked)if(this.state.checked[a]){b=!1;break}const c=this.state.showMask?{}:{display:"none"};return React.createElement("div",{className:"container",style:{top:0,width:"100%",position:"fixed"}},React.createElement("div",{className:"ui-mask ui-mask-transparent",style:c}),React.createElement("div",null,React.createElement("div",null,React.createElement("div",{className:"pm-container"},React.createElement("div",{className:"pm-list"},a),React.createElement("div",{className:"pm-action"},React.createElement("button",{className:"ui-button ui-button-primary",onClick:this.toggleAllCheckbox},locales.config.INVERSE_SELECT),React.createElement("button",{className:"ui-button ui-button-warn",onClick:this.onDelMultiple,disabled:b},locales.config.DELETE),React.createElement("button",{className:"ui-button ui-button-primary",onClick:this.onNew},locales.config.PROJECT_NEW))))))}};ProjectManagement=tslib_1.__decorate([locales.mixin],ProjectManagement),module.exports=ProjectManagement;
;}(require("lazyload"), require);
