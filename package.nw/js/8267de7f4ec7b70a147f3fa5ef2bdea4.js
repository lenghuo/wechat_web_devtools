'use strict';var _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};!function(require,directRequire){function a(a,b){let c=new Error(a);throw c.code=b,c}function b(b,c){'string'!=m.getType(b)&&a(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'string']),x.APP_JSON_CONTENT_ERR),0<=b.indexOf('\\')&&a(n.config.JSON_SHOULD_NOT_CONTAIN.format([`${c}`,'\\']),x.APP_JSON_CONTENT_ERR),0==b.indexOf('.')&&a(n.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'.']),x.APP_JSON_CONTENT_ERR),0==b.indexOf('/')&&a(n.config.JSON_SHOULD_NOT_START_WITH.format([`${c}`,'/']),x.APP_JSON_CONTENT_ERR)}function c(b){const{permission:c}=b;if('undefined'!=typeof c){'object'!==m.getType(c)&&a(n.config.JSON_CONTENT_SHOULD_BE.format(['permission','object']),x.APP_JSON_CONTENT_ERR);const b=c['scope.userLocation'];'undefined'!=typeof b&&('object'!==m.getType(b)&&a(n.config.JSON_CONTENT_SHOULD_BE.format(['permission["scope.userLocation"]','object']),x.APP_JSON_CONTENT_ERR),'undefined'==typeof b.desc||'string'!==m.getType(b.desc)&&a(n.config.JSON_CONTENT_SHOULD_BE.format(['permission["scope.userLocation"].desc','string']),x.APP_JSON_CONTENT_ERR))}}function d(a,b){function c(b,c){return'object'==m.getType(b)?'string'==m.getType(b.provider)?'string'==m.getType(b.version)?a.compileType!=p.plugin&&'dev'==b.version?void d.push(n.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${c}.version`,'dev'])+'\n'+n.config.PLEASE_CHOOSE_PLUGIN_MODE):a.compileType==p.plugin&&'dev'==b.version&&b.provider!=a.appid?void d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,a.appid])):'dev'==b.version||/^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$/.test(b.version)||void d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,n.config.TRIPLE_NUMBER_DOT])):void d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}.version`,'string'])):void d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}.provider`,'string'])):void d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${c}`,'object']))}const d=[],e=b.plugins;if(!e)return d;if('object'!=m.getType(e))return d.push(n.config.JSON_CONTENT_SHOULD_BE.format(['plugins','object'])),d;const f={};for(const g in e){const a=e[g];c(a,`plugins.${g}`)&&(f[a.provider]?d.push(n.config.PLUGINS_MULTI_PROVIDER.format(a.provider)):f[a.provider]={provider:a.provider,version:a.version,alias:g})}if(b.subPackages&&b.subPackages.forEach((a,b)=>{if(a.plugins)for(const g in a.plugins){const h=a.plugins[g];(e[g]&&d.push(n.config.JSON_PLUGIN_SHOULD_NOT_IN_SUBPACKAGE.format([`plugins ${g}`,`subPackages[${b}]`])),!!c(h,`subPackages[${b}].plugins.${g}`))&&(f[h.provider]?d.push(`subPackages[${b}].plugins['${g}'].provider ${n.config.ALREADY_EXISTS}`):f[h.provider]={provider:h.provider,version:h.version,alias:h})}}),0<d.length){const a=new Error(d.join('\n'));throw a.code=x.APP_JSON_CONTENT_ERR,a}}function e(c,d,e){const f=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),g=_extends({},f.setting,c.runtimeAttr&&c.runtimeAttr.setting);let h='subPackages';e.subpackages&&(h='subpackages',e.subPackages=e.subpackages,delete e.subpackages);const i=e.pages||[];let j=!1;if(e.subPackages){'array'!=m.getType(e.subPackages)&&a(n.config.JSON_CONTENT_SHOULD_BE.format([h,'array']),x.APP_JSON_CONTENT_ERR),e.subPackages.length>g.MaxSubPackageLimit&&a(n.config.EXCEED_LIMIT.format([h,g.MaxSubPackageLimit]));const c={},f={},o=[];e.subPackages.forEach((a,g)=>{if(b(a.root,`${h}[${g}].root`),a.root===s.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void o.push(n.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${g}].root`,s.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(a.name){if('string'!==m.getType(a.name))return void o.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].name`,'string']));if(a.name===s.MINI_PROGRAM_MAIN_PACKAGE_ROOT)return void o.push(n.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${g}].name`,s.MINI_PROGRAM_MAIN_PACKAGE_ROOT]));if(f[a.name])return void o.push(n.config.JSON_SUBPACKAGE_EXIST.format([`${h}[${g}].name`]));f[a.name]=!0}if(a.root=m.normalizePath(a.root+'/'),c[a.root])return void o.push(n.config.JSON_SUBPACKAGE_EXIST.format([`${h}[${g}].root`]));if(c[a.root]=!0,!l.existsSync(k.join(d,a.root)))return void o.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].root`,n.config.DIRECTORY]));const p=l.statSync(k.join(d,a.root));if(!p.isDirectory())return void o.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].root`,n.config.DIRECTORY]));if(i.forEach((b)=>{0==b.indexOf(a.root)&&o.push(n.config.JSON_PAGE_SHOULD_NOT_IN_SUBPACKAGE.format([`pages ${b}`,`${h}[${g}]`]))}),'array'!=m.getType(a.pages))return void o.push(n.config.JSON_CONTENT_SHOULD_BE.format([`${h}[${g}].pages`,'array']));const q={};for(let c=0,f=a.pages.length;c<f;c++){const f=a.pages[c];b(f,`${h}[${g}].pages[${c}]`);const i=m.normalizePath(k.posix.join(a.root,f));if(q[i]){o.push(n.config.JSON_PAGES_REPEAT.format([`${h}[${g}]`,f]));continue}q[i]=!0,j||i!=e.entryPagePath||(j=!0),l.existsSync(k.join(d,`${i}\.wxml`))||o.push(n.config.JSON_PAGE_WXML_NOT_EXISTS.format([`${h}[${g}]`,'pages',i])),l.existsSync(k.join(d,`${i}\.js`))||o.push(n.config.JSON_PAGE_JS_NOT_EXISTS.format([`${h}[${g}]`,'pages',i]))}}),0<o.length&&a(o.join('\n'),x.APP_JSON_CONTENT_ERR),e.subPackages.forEach((a,b)=>{let c=-1;const d='/'+a.root;if(e.subPackages.forEach((a,e)=>{if(e!=b&&a.root){const b='/'+a.root;0==d.indexOf(b)&&(c=e)}}),-1!=c)return void o.push(n.config.JSON_CONTENT_SHOULD_NOT_BE.format([`${h}[${b}].root`,`${h}[${c}].root 的子目录`]))}),0<o.length&&a(o.join('\n'),x.APP_JSON_CONTENT_ERR)}return j}function f(b){if(b.preloadRule&&b.subPackages){'object'!==m.getType(b.preloadRule)&&a(n.config.JSON_CONTENT_SHOULD_BE.format(['preloadRule','object']),x.APP_JSON_CONTENT_ERR);let c=[],d=[].concat(b.pages),e={},f={};for(let a=0,c=b.subPackages.length;a<c;a++){const c=b.subPackages[a],g=c.pages.map((a)=>{return k.posix.join(c.root,a)});e[c.root]=!0,c.name&&(f[c.name]=!0),d=d.concat(g)}for(const a in b.preloadRule){if(-1===d.indexOf(a)){c.push(n.config.NOT_FOUND.format(`preloadRule['${a}'] ${n.config.PAGE_PATH}`));continue}const g=b.preloadRule[a];if(g.network){if('string'!==m.getType(g.network)){c.push(n.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'string']));continue}if(-1===['all','wifi'].indexOf(g.network)){c.push(n.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].network`,'all/wifi']));continue}}if('array'!==m.getType(g.packages)){c.push(n.config.JSON_CONTENT_SHOULD_BE.format([`preloadRule['${a}'].packages`,'array']));continue}for(let b,d=0,h=g.packages.length;d<h;d++)if((b=g.packages[d],b!==s.MINI_PROGRAM_MAIN_PACKAGE_ROOT)&&!f[b]&&(b=m.normalizePath(b+'/'),!e[b])){c.push(n.config.NOT_FOUND.format(`preloadRule['${a}'].packages[${d}]: ${b}`));continue}}0<c.length&&a(c.join('\n'),x.APP_JSON_CONTENT_ERR)}}async function g(c,d){const e=await q(c),f=e.srcPath,g=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),h=_extends({},g.setting,c.runtimeAttr&&c.runtimeAttr.setting),j=d.pages,o=d.tabBar;let p=[];if(o){'array'!=m.getType(o.list)&&a(n.config.JSON_TABBAR_SHOULD_BE_LIST,x.APP_JSON_CONTENT_ERR),o.list.length<h.MinTabbarCount&&a(n.config.JSON_TABBAR_AT_LEAST.format(h.MinTabbarCount),x.APP_JSON_CONTENT_ERR),o.list.length>h.MaxTabbarCount&&a(n.config.JSON_TABBAR_AT_MOST.format(h.MaxTabbarCount),x.APP_JSON_CONTENT_ERR);for(var r=0;r<o.list.length;r++){let a=o.list[r];if('object'!=m.getType(a)){p.push(n.config.JSON_TABBAR_ITEM_OBJECT.format(r));continue}const c=a.pagePath;if(b(c,`tabBar[${r}].pagePath`),!c){p.push(n.config.JSON_TABBAR_PATH_EMPTY.format(r));continue}if(0>j.indexOf(c)){p.push(`tabBar[${r}].pagePath "${c}" 需在 pages 数组中`);continue}2<=c.split('?').length&&p.push(n.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'?'])),2<=c.split('.').length&&p.push(n.config.JSON_TABBAR_PATH_NOT_CONTAIN.format([r,'.']));let d=[];if(a.iconPath){let b=k.join(f,a.iconPath);a.iconPath=k.relative(f,b),d.push({name:'iconPath',path:b})}if(a.selectedIconPath){let b=k.join(f,a.selectedIconPath);a.selectedIconPath=k.relative(f,b),d.push({name:'selectedIconPath',path:b})}d.forEach((a)=>{if(!l.existsSync(a.path))return p.push(n.config.JSON_TABBAR_ICON_NOT_FOUND.format([r,a.name]));let b=l.statSync(a.path);if(b.isDirectory())return p.push(n.config.JSON_TABBAR_ICON_NOT_DIR.format([r,a.name]));b.size>1024*h.MaxTabbarIconSize&&p.push(n.config.JSON_TABBAR_ICON_MAX_SIZE.format([r,a.name,h.MaxTabbarIconSize]));let c=k.extname(a.path);0>w.indexOf(c)&&p.push(n.config.JSON_TABBAR_ICON_EXT.format([r,a.name,w.join('\u3001')]))})}}0<p.length&&a(p.join('\n'),x.APP_JSON_CONTENT_ERR)}function h(b,c){const d=[];if(c.navigateToMiniProgramAppIdList){'array'!==m.getType(c.navigateToMiniProgramAppIdList)&&a(n.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList`,'array'])),c.navigateToMiniProgramAppIdList.forEach((a,b)=>{'string'!==m.getType(a)&&d.push(n.config.JSON_CONTENT_SHOULD_BE.format([`navigateToMiniProgramAppIdList[${b}]`,'string']))});const e=b.runtimeAttr&&b.runtimeAttr.appType||v.APP_TYPE.NORMAL;if(e!==v.APP_TYPE.NATIVE){const a=b.runtimeAttr&&b.runtimeAttr.setting&&b.runtimeAttr.setting.NavigateMiniprogramLimit||v.setting.NavigateMiniprogramLimit;c.navigateToMiniProgramAppIdList.length>a&&d.push(n.config.EXCEED_LIMIT.format([`navigateToMiniProgramAppIdList`,a]))}}0<d.length&&a(d.join('\n'),x.APP_JSON_CONTENT_ERR)}function i(c,d){const{workers:e}=d;if(e){b(e,'workers');const d=k.join(c,e);l.existsSync(d)||a(n.config.JSON_CONTENT_SHOULD_BE.format([`workers`,n.config.DIRECTORY]));const f=l.statSync(d);f.isDirectory()||a(n.config.JSON_CONTENT_SHOULD_BE.format([`workers`,n.config.DIRECTORY]))}}async function j(j){const r=await q(j),s=r.srcPath,v=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),w='app.json';let y='',z=[];try{y=r.getFile(w)}catch(a){const b=new Error(n.config.FILE_NOT_FOUND.format(w));throw b.code=x.APP_JSON_READ_ERR,b.ext=a.toString(),b}let A={};try{A=JSON.parse(y)}catch(b){const c=t.parseJsonParseErr({data:y,error:b});a(c,x.APP_JSON_PARSE_ERR)}'string'==m.getType(A.entryPagePath)&&b(A.entryPagePath,'entryPagePath');const B=A.pages||[];('array'!=m.getType(B)||0===B.length)&&a(n.config.ENTRANCE_NOT_FOUND.format(JSON.stringify(B)),x.APP_JSON_ENTRANCE_NOT_FOUND_ERR);let C=!A.entryPagePath;const D={};for(let c=0;c<B.length;c++){const d=B[c];b(d,`pages[${c}]`),D[d]&&a(n.config.JSON_PAGES_REPEAT.format([w,d]),x.APP_JSON_PAGES_ERR),D[d]=!0,C||d!=A.entryPagePath||(C=!0),l.existsSync(k.join(s,`${d}\.wxml`))||a(n.config.JSON_PAGE_WXML_NOT_EXISTS.format([w,'pages',d]),x.APP_JSON_WXML_NOT_FOUND),l.existsSync(k.join(s,`${d}\.js`))||a(n.config.JSON_PAGE_JS_NOT_EXISTS.format([w,'pages',d]),x.APP_JSON_JS_NOT_FOUND)}await g(j,A);const E=j.compileType;if(E==p.conversation||E==p.search){const a=A.widgets;let b,c='';if(!a)b=new Error(n.config.JSON_WIDGETS_EMPTY.format('app.json'));else if('array'!=m.getType(a))b=new Error(n.config.JSON_WIDGETS_NOT_ARRAY.format('app.json'));else{const d=[];a.forEach((a,b)=>{if('object'!=m.getType(a))d.push(n.config.JSON_WIDGETS_ITEM_NOT_OBJECT.format(['app.json',b]));else if('conversation'!=a.type&&'search'!=a.type)d.push(n.config.JSON_WIDGETS_TYPE_INVALID.format(['app.json',b,'conversation\u3001search']));else if(!a.path||'string'!=m.getType(a.path))d.push(n.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else if(!l.existsSync(k.join(s,a.path)))d.push(n.config.JSON_WIDGETS_PATH_NOT_FOUND.format(['app.json',b]));else{const c=l.statSync(k.join(s,a.path));c.isDirectory()?!l.existsSync(k.join(s,a.path,'widget.js'))&&d.push(n.config.JSON_WIDGETS_JS_NOT_FOUND.format(['app.json',b,'widget.js'])):d.push(n.config.JSON_WIDGETS_PATH_SHOULD_BE_DIR.format(['app.json',b]))}c||a.type!=j.compileType||(c=a.path)}),c||d.push(n.config.JSON_WIDGETS_TYPE_NOT_FOUND.format(['app.json',j.compileType])),0<d.length&&(b=new Error(d.join('\n')))}if(b)throw b.code=x.APP_JSON_CONTENT_ERR,b}delete A.extAppid;const F=await o(j);if(F)for(const a in F)'extPages'!=a&&(A[a]='object'==m.getType(F[a])?Object.assign({},A[a]||{},F[a]):F[a]);const G=e(j,s,A);return C=C||G,C||a(n.config.JSON_ENTRY_PAGE_PATH_NOT_FOUND.format(['pages\u3001subPackages','entryPagePath']),x.APP_JSON_PAGES_ERR),d(j,A),f(A),i(s,A),c(A),A.window&&(z=[],['enablePullDownRefresh'].forEach((a)=>{'undefined'!=typeof A.window[a]&&'boolean'!=typeof A.window[a]&&z.push(n.config.JSON_CONTENT_SHOULD_BE.format([a,'boolean']))}),A.window.backgroundColorTop&&(A.window.backgroundColor=A.window.backgroundColorTop)),A.usingComponents&&u.checkUsingComponents(A,{msg:z,filePath:'app.json',JSON_PARSE_ERR:x.APP_JSON_PARSE_ERR}),h(j,A),0<z.length&&a(z.join('\n'),x.APP_JSON_CONTENT_ERR),A}const k=require('path'),l=require('fs'),m=require('./84b183688a46c9e2626d3e6f83365e13.js'),n=require('./common/locales/index.js'),o=require('./551bb965e1f344281d555a429cd2140c.js'),p=require('./9fdd4ac31a05c27355910f0d74accd4c.js'),q=require('./162bf2ee28b76d3b3d95b685cede4146.js'),r=require('./2dfc6a3df6d6fc51266b293c8420e88b.js'),s=require('./56c390e04c10e91a4aa2a2c19d9a885d.js'),t=require('./6238a86bb7a55c11aa0f9eb335d0f34c.js'),u=require('./464e9598eb5c203da6b41e702e422c70.js'),v=require('./6242f55dbdfe53c2f07b7a51568311f2.js'),w=['.png','.jpg','.jpeg'],x=require('./949d8235c744ced2a80121e4dba34c28.js');module.exports=async function(a){try{return await j(a)}catch(a){throw a.code||(a.code=x.APP_JSON_CONTENT_ERR),a}}}(require('lazyload'),require);